import java.util.InputMismatchException;
import java.util.Random;
import java.util.Scanner;

public class Main {

    private static final int minVal = 2;
    private static final int maxVal = 20;
    private static final int[] possibleNums = {2, 4, 6, 8, 10, 12, 14, 16, 18, 20};

    public static void main(String[] args) {
        Scanner scan = new Scanner(System.in);
        int size = 0;
        int[][] grid = null;

        do {
            System.out.print("Enter array size (for NxN array): ");
            try {
                if (scan.hasNextInt()) {
                    size = scan.nextInt();
                    if (size > 0) {
                        
                        grid = generateGrid(size); 
                        System.out.println("\nGenerated 2D array:");
                        displayGrid(size, grid, 0); 
                        break;
                    } else {
                        System.out.println("Invalid input. Please enter a positive integer for the array size.");
                    }
                } else {
                    String input = scan.next();
                    System.out.println("Invalid input '" + input + "'. Please enter a valid integer for the array size.");
                }
            } catch (Exception e) {
                System.out.println("An unexpected error occurred during size input. Please try again.");
                scan.nextLine(); 
            }
        } while (true);

        int highlightNum = 0;
        int count = 0;
        
        if (scan.hasNextLine()) { 
            scan.nextLine();
        }

        do {
           
            System.out.print("\nEnter a number to highlight (even number " + minVal + "-" + maxVal + "): ");
            try {
                if (scan.hasNextInt()) {
                    highlightNum = scan.nextInt();
                    
                    if (highlightNum >= minVal && highlightNum <= maxVal && highlightNum % 2 == 0) {
                        System.out.println("\nStep 2:");
                        System.out.println("Enter a number to highlight (even number " + minVal + "-" + maxVal + "): " + highlightNum);
                        
                        
                        displayGrid(size, grid, highlightNum); 
                        
                     
                        count = countOccurrences(size, grid, highlightNum);

                        System.out.println("\nNumber " + highlightNum + " appeared " + count + " time(s)");
                        break;
                    } else {
                        System.out.println("Invalid input. Please enter an even number between " + minVal + " and " + maxVal + ".");
                    }
                } else {
                    String input = scan.next();
                    System.out.println("Invalid input '" + input + "'. Please enter a valid even number between " + minVal + " and " + maxVal + ".");
                }
            } catch (Exception e) {
                System.out.println("An unexpected error occurred during highlight input. Please try again.");
                scan.nextLine();
            }
        } while (true);

        scan.close();
    }

    private static int[][] generateGrid(int size) {
        int[][] grid = new int[size][size];
        
        long seed;
        if (size == 8) {
   
            seed = 18; 
        } else if (size == 6) {
            
            seed = 28;
        } else {
  
            seed = System.currentTimeMillis();
        }
        
        Random rand = new Random(seed); 

        for (int i = 0; i < size; i++) {
            for (int j = 0; j < size; j++) {
                int randomIndex = rand.nextInt(possibleNums.length);
                grid[i][j] = possibleNums[randomIndex];
            }
        }
        return grid;
    }

    private static int countOccurrences(int size, int[][] grid, int highlightNum) {
        int count = 0;
        for (int i = 0; i < size; i++) {
            for (int j = 0; j < size; j++) {
                if (grid[i][j] == highlightNum) {
                    count++;
                }
            }
        }
        return count;
    }

    private static void displayGrid(int size, int[][] grid, int highlightNum) {
        System.out.print("    "); 
        for (int j = 0; j < size; j++) {
            System.out.printf("%2d", j); 
            if (j < size - 1) {
                System.out.print(" | "); 
            } else {
                System.out.print(" "); 
            }
        }
        System.out.println();

        printSeparator(size);

        for (int i = 0; i < size; i++) {
            System.out.printf("%2d|", i); 

            for (int j = 0; j < size; j++) {
                int val = grid[i][j];
                String cellText;

                if (highlightNum > 0 && val == highlightNum) {
                    if (val < 10) {
                        cellText = String.format("[%d] ", val);
                    } else {
                        cellText = String.format("[%d]", val);
                    }
                } else {
                    if (val < 10) {
                        cellText = String.format("  %d ", val);
                    } else {
                        cellText = String.format(" %d ", val);
                    }
                }
                
                System.out.printf("%s|", cellText);
            }
            
            System.out.println();
            
            printSeparator(size);
        }
    }

    private static void printSeparator(int size) {
        System.out.print("+---"); 
        for (int j = 0; j < size; j++) {
            System.out.print("----+"); 
        }
        System.out.println();
    }
}
